# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üéØ –ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å

–°–¥–µ–ª–∞—Ç—å –ø–∞—Ä—Å–µ—Ä Ozon **–ø—Ä–æ—â–µ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏** –∏ **–≥–æ—Ç–æ–≤—ã–º –∫ —Ö–æ—Å—Ç–∏–Ω–≥—É** (Railway/Fly.io) –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –±—Ä–∞—É–∑–µ—Ä—ã.

---

## üì¶ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. **Cookies-as-a-Service** (–ü–æ–ª—É—á–µ–Ω–∏–µ cookies –ª–æ–∫–∞–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

#### –ü—Ä–æ–±–ª–µ–º–∞:
- Playwright –Ω—É–∂–µ–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è cookies, –Ω–æ –æ–Ω —Ç—è–∂–µ–ª—ã–π (~1.5 GB)
- –ù–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ (Railway/Fly.io) –Ω–µ —Ö–æ—á–µ—Ç—Å—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –±—Ä–∞—É–∑–µ—Ä—ã
- Cookies –Ω—É–∂–Ω—ã –¥–ª—è –æ–±—Ö–æ–¥–∞ –∞–Ω—Ç–∏–±–æ—Ç–∞ Ozon

#### –†–µ—à–µ–Ω–∏–µ:
**–®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ cookies –Ω–∞ –≤–∞—à–µ–º –ü–ö (–≥–¥–µ –µ—Å—Ç—å Playwright)**
```bash
python tools/get_cookies.py
```
–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –ó–∞–ø—É—Å–∫–∞–µ—Ç Playwright (–±—Ä–∞—É–∑–µ—Ä)
- –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–∞–π—Ç Ozon
- –ü–æ–ª—É—á–∞–µ—Ç cookies –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ —Ñ–∞–π–ª `cookies/ozon_cookies.json`

**–®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–±–µ–∑ Playwright)**
- –ö–æ–ø–∏—Ä—É–µ—Ç–µ —Ñ–∞–π–ª `cookies/ozon_cookies.json` –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –ü–∞—Ä—Å–µ—Ä —á–∏—Ç–∞–µ—Ç cookies –∏–∑ —Ñ–∞–π–ª–∞
- Playwright –ù–ï –Ω—É–∂–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!

#### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–¥–µ:
```python
# –í OzonCatalogAPI.__aenter__():
# 1. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞
if await self._load_cookies_from_file():
    # ‚úÖ Cookies –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞
    pass
# 2. –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç - –ø–æ–ª—É—á–∞–µ–º –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ (fallback)
else:
    await self._load_cookies_from_browser()
```

**–§–∞–π–ª—ã:**
- `tools/get_cookies.py` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è cookies
- `src/api/ozon_catalog_api.py` - –º–µ—Ç–æ–¥ `_load_cookies_from_file()`

---

### 2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** (requirements-core.txt vs requirements-playwright.txt)

#### –ü—Ä–æ–±–ª–µ–º–∞:
- –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ `requirements.txt`
- Playwright —Ç—è–∂–µ–ª—ã–π, –Ω–æ –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ
- –ù–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ –Ω–µ –Ω—É–∂–µ–Ω Playwright

#### –†–µ—à–µ–Ω–∏–µ:
–†–∞–∑–¥–µ–ª–∏–ª–∏ –Ω–∞ 3 —Ñ–∞–π–ª–∞:

**`requirements-core.txt`** - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã:
```
curl-cffi      # HTTP –∑–∞–ø—Ä–æ—Å—ã —Å –æ–±—Ö–æ–¥–æ–º –∞–Ω—Ç–∏–±–æ—Ç–∞
aiohttp        # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
pandas         # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
openpyxl       # –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
loguru         # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
python-dotenv  # –ß—Ç–µ–Ω–∏–µ .env
```
**–†–∞–∑–º–µ—Ä:** ~50 MB

**`requirements-playwright.txt`** - —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è cookies:
```
playwright           # –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
playwright-stealth   # –û–±—Ö–æ–¥ –∞–Ω—Ç–∏–±–æ—Ç–æ–≤
selenium             # Fallback –¥–ª—è cookies
```
**–†–∞–∑–º–µ—Ä:** ~1.5 GB (–±—Ä–∞—É–∑–µ—Ä—ã)

**`requirements-dev.txt`** - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```
black    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
pytest   # –¢–µ—Å—Ç—ã
mypy     # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```bash
# –ù–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ (LIGHT —Ä–µ–∂–∏–º):
pip install -r requirements-core.txt  # –¢–æ–ª—å–∫–æ ~50 MB

# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –ü–ö (FULL —Ä–µ–∂–∏–º):
pip install -r requirements-core.txt
pip install -r requirements-playwright.txt  # + –±—Ä–∞—É–∑–µ—Ä—ã
playwright install chromium
```

---

### 3. **–†–µ–∂–∏–º—ã LIGHT/FULL** (HTTP-only vs —Å Playwright fallback)

#### –ü—Ä–æ–±–ª–µ–º–∞:
- –ù–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ –Ω–µ—Ç Playwright
- –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –∞–Ω—Ç–∏–±–æ—Ç–æ–º –Ω—É–∂–µ–Ω fallback –Ω–∞ Playwright
- –ù–æ Playwright –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ

#### –†–µ—à–µ–Ω–∏–µ:
–î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã:

**LIGHT —Ä–µ–∂–∏–º** (`OZON_MODE=light`):
- –¢–æ–ª—å–∫–æ HTTP –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ `curl_cffi`
- –ù–ï–¢ Playwright fallback
- –ï—Å–ª–∏ –∞–Ω—Ç–∏–±–æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª ‚Üí –æ—à–∏–±–∫–∞ (–Ω–æ —Å cookies –æ–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- –î–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞ (Railway/Fly.io)

**FULL —Ä–µ–∂–∏–º** (`OZON_MODE=full`):
- HTTP –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ `curl_cffi`
- –ï–°–¢–¨ Playwright fallback –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ
- –ï—Å–ª–∏ –∞–Ω—Ç–∏–±–æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—É–µ—Ç —á–µ—Ä–µ–∑ Playwright
- –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ü–ö

#### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–¥–µ:
```python
# –í OzonCatalogAPI.__init__():
self.mode = os.getenv('OZON_MODE', 'full')  # light –∏–ª–∏ full

# –í _fetch_page() –ø—Ä–∏ –æ—à–∏–±–∫–µ 403:
if response.status_code == 403:
    if self.mode == 'full':
        # ‚úÖ –ü—Ä–æ–±—É–µ–º Playwright fallback
        playwright_result = await self._fetch_page_via_playwright(...)
    else:
        # ‚ùå LIGHT —Ä–µ–∂–∏–º - Playwright –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
        logger.error("LIGHT —Ä–µ–∂–∏–º: Playwright fallback –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")
```

**–§–∞–π–ª—ã:**
- `src/api/ozon_catalog_api.py` - –ª–æ–≥–∏–∫–∞ —Ä–µ–∂–∏–º–æ–≤
- `.env_sample` - –ø–∞—Ä–∞–º–µ—Ç—Ä `OZON_MODE`

---

### 4. **–§–∏–∫—Å Seller API** (–ø—Ä–æ–ø—É—Å–∫ –¥–ª—è —á—É–∂–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞)

#### –ü—Ä–æ–±–ª–µ–º–∞:
- Seller API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –≤–∞—à–µ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
- –ï—Å–ª–∏ –ø–∞—Ä—Å–∏—Ç–µ —á—É–∂–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞ ‚Üí Seller API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ù–æ –∑–∞–ø—Ä–æ—Å—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –¥–µ–ª–∞—é—Ç—Å—è (—Ç—Ä–∞—Ç–∏—Ç—Å—è –≤—Ä–µ–º—è)

#### –†–µ—à–µ–Ω–∏–µ:
–ü–∞—Ä–∞–º–µ—Ç—Ä `OZON_ACCOUNT_TYPE`:
- `my` - —Å–≤–æ–π –∫–∞–±–∏–Ω–µ—Ç (–∏—Å–ø–æ–ª—å–∑—É–µ–º Seller API)
- `foreign` - —á—É–∂–æ–π –ø—Ä–æ–¥–∞–≤–µ—Ü (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º Seller API)

#### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```python
# –í OzonParser.parse_seller_catalog():
account_type = os.getenv('OZON_ACCOUNT_TYPE', 'foreign')

if account_type == 'foreign':
    # ‚úÖ –ü—Ä–æ–ø—É—Å–∫–∞–µ–º Seller API –ø–æ–ª–Ω–æ—Å—Ç—å—é
    logger.info("Seller API –ø—Ä–æ–ø—É—â–µ–Ω (—á—É–∂–æ–π –ø—Ä–æ–¥–∞–≤–µ—Ü)")
else:
    # ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º Seller API
    seller_items = await seller_api.fetch_product_prices(...)
```

**–§–∞–π–ª—ã:**
- `src/parsers/ozon_parser.py` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –∞–∫–∫–∞—É–Ω—Ç–∞
- `.env_sample` - –ø–∞—Ä–∞–º–µ—Ç—Ä `OZON_ACCOUNT_TYPE`

---

### 5. **Dockerfile –¥–ª—è HTTP-only** (–ª–µ–≥–∫–∏–π –æ–±—Ä–∞–∑ –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞)

#### –ü—Ä–æ–±–ª–µ–º–∞:
- –û–±—ã—á–Ω—ã–π Dockerfile —Å Playwright = ~1.5 GB –æ–±—Ä–∞–∑
- –ù–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ Playwright –Ω–µ –Ω—É–∂–µ–Ω
- –ë–æ–ª—å—à–æ–π –æ–±—Ä–∞–∑ = –º–µ–¥–ª–µ–Ω–Ω—ã–π –¥–µ–ø–ª–æ–π

#### –†–µ—à–µ–Ω–∏–µ:
–°–æ–∑–¥–∞–Ω –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π Dockerfile:
```dockerfile
FROM python:3.12-slim          # –õ–µ–≥–∫–∏–π –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑
WORKDIR /app
COPY requirements-core.txt .   # –¢–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
RUN pip install -r requirements-core.txt
COPY . .
CMD ["python", "parse_ozon_sellers.py"]
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û–±—Ä–∞–∑ ~150 MB –≤–º–µ—Å—Ç–æ ~1.5 GB
- –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ Railway/Fly.io
- Playwright –ù–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–Ω–µ –Ω—É–∂–µ–Ω)

**–§–∞–π–ª—ã:**
- `Dockerfile` - –ª–µ–≥–∫–∏–π –æ–±—Ä–∞–∑
- `.dockerignore` - –∏—Å–∫–ª—é—á–∞–µ—Ç –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã

---

### 6. **AdaptiveDelayer** (—É–º–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–µ–∫)

#### –ü—Ä–æ–±–ª–µ–º–∞:
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3 —Å–µ–∫—É–Ω–¥—ã)
- –ï—Å–ª–∏ –∞–Ω—Ç–∏–±–æ—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç ‚Üí –Ω—É–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É
- –ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É (–±—ã—Å—Ç—Ä–µ–µ –ø–∞—Ä—Å–∏–Ω–≥)

#### –†–µ—à–µ–Ω–∏–µ:
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∑–∞–¥–µ—Ä–∂–µ–∫:

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ (403) ‚Üí —É–≤–µ–ª–∏—á–∏—Ç—å delay –Ω–∞ 50%
- –ü–æ—Å–ª–µ 5 —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí —É–º–µ–Ω—å—à–∏—Ç—å delay –Ω–∞ 20%
- –ú–∏–Ω–∏–º—É–º: 0.5 —Å–µ–∫, –ú–∞–∫—Å–∏–º—É–º: 5 —Å–µ–∫

#### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```python
# –í AdaptiveDelayer:
def on_block(self):
    # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º delay
    self.current_delay = min(5.0, self.current_delay * 1.5)  # +50%

def on_success(self):
    # –£—Å–ø–µ—Ö ‚Üí —É–º–µ–Ω—å—à–∞–µ–º delay (–ø–æ—Å–ª–µ 5 —É—Å–ø–µ—à–Ω—ã—Ö)
    if self.success_count >= 5:
        self.current_delay = max(0.5, self.current_delay * 0.8)  # -20%

# –í OzonCatalogAPI._fetch_page():
if response.status_code == 200:
    self.adaptive_delayer.on_success()  # ‚úÖ –£—Å–ø–µ—Ö
elif response.status_code == 403:
    self.adaptive_delayer.on_block()    # ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É:
delay = self.adaptive_delayer.get_delay()
await asyncio.sleep(delay)
```

**–§–∞–π–ª—ã:**
- `src/utils/adaptive_delayer.py` - –∫–ª–∞—Å—Å AdaptiveDelayer
- `src/api/ozon_catalog_api.py` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

---

### 7. **–ê–≤—Ç–æ-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Seller API** (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Å–Ω–æ–≤–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º)

#### –ü—Ä–æ–±–ª–µ–º–∞:
- Seller API –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è —á—É–∂–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞
- –ù–æ –º—ã –¥–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ (—Ç—Ä–∞—Ç–∏—Ç—Å—è –≤—Ä–µ–º—è)
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—Ä–∞–Ω–µ–µ

#### –†–µ—à–µ–Ω–∏–µ:
–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å —Å 1 SKU –ø–µ—Ä–µ–¥ –æ—Å–Ω–æ–≤–Ω—ã–º:

```python
# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å:
test_items = await seller_api.fetch_product_prices([test_sku])

if len(test_items) == 0:
    # ‚ùå Seller API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞
    logger.warning("–ü—Ä–æ–ø—É—Å–∫–∞–µ–º Seller API")
else:
    # ‚úÖ Seller API —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–µ–ª–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å
    seller_items = await seller_api.fetch_product_prices(all_skus)
```

**–§–∞–π–ª—ã:**
- `src/parsers/ozon_parser.py` - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º

---

### 8. **–°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ-—É—Å—Ç–∞–Ω–æ–≤–∫–∏** (–ø—Ä–æ—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –Ω–æ–≤–æ–º –ü–ö)

#### –ü—Ä–æ–±–ª–µ–º–∞:
- –ù—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –†–∞–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è Windows/Linux
- –õ–µ–≥–∫–æ –∑–∞–±—ã—Ç—å —à–∞–≥–∏

#### –†–µ—à–µ–Ω–∏–µ:
–ì–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:

**Windows (`install.bat`):**
```batch
python -m venv venv
venv\Scripts\activate.bat
pip install -r requirements-core.txt
```

**Linux/Mac (`install.sh`):**
```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements-core.txt
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# Windows:
install.bat

# Linux/Mac:
chmod +x install.sh
./install.sh
```

**–§–∞–π–ª—ã:**
- `install.sh` - –¥–ª—è Linux/Mac
- `install.bat` - –¥–ª—è Windows

---

### 9. **Railway/Fly.io templates** (–≥–æ—Ç–æ–≤—ã–π –¥–µ–ø–ª–æ–π)

#### –ü—Ä–æ–±–ª–µ–º–∞:
- –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –¥–µ–ø–ª–æ–π –≤—Ä—É—á–Ω—É—é
- –ù–µ–ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω—É–∂–Ω—ã
- –†–∞–∑–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º

#### –†–µ—à–µ–Ω–∏–µ:
–ì–æ—Ç–æ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

**`railway.toml`** - –¥–ª—è Railway:
```toml
[build]
builder = "dockerfile"
dockerfilePath = "Dockerfile"

[deploy]
startCommand = "python parse_ozon_sellers.py"
```

**`fly.toml`** - –¥–ª—è Fly.io:
```toml
app = "ozon-parser"
[build]
  dockerfile = "Dockerfile"
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# Railway:
railway login
railway init
railway up

# Fly.io:
fly launch
fly secrets set OZON_CLIENT_ID=...
fly deploy
```

**–§–∞–π–ª—ã:**
- `railway.toml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Railway
- `fly.toml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Fly.io
- `README.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –¥–µ–ø–ª–æ—é

---

### 10. **Config dataclass** (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

#### –ü—Ä–æ–±–ª–µ–º–∞:
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ `.env` –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö –∫–æ–¥–∞
- –°–ª–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –≤—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### –†–µ—à–µ–Ω–∏–µ:
–ï–¥–∏–Ω—ã–π –∫–ª–∞—Å—Å `OzonConfig`:

```python
@dataclass
class OzonConfig:
    mode: Mode = Mode.FULL
    client_id: int = 0
    api_key: str = ""
    seller_id: int = 176640
    account_type: AccountType = AccountType.FOREIGN
    cookies_path: str = "cookies/ozon_cookies.json"
    # ... –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
config = load_config()
if config.validate():
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º config.mode, config.client_id –∏ —Ç.–¥.
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- –¢–∏–ø–∏–∑–∞—Ü–∏—è (enum –¥–ª—è mode, account_type)
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–§–∞–π–ª—ã:**
- `src/config.py` - –∫–ª–∞—Å—Å OzonConfig

---

## üîÑ –ö–∞–∫ –≤—Å–µ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–º–µ—Å—Ç–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –õ–æ–∫–∞–ª—å–Ω—ã–π –ü–ö (FULL —Ä–µ–∂–∏–º)

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
   ```bash
   ./install.sh  # –∏–ª–∏ install.bat
   pip install -r requirements-playwright.txt
   playwright install chromium
   ```

2. **–ü–æ–ª—É—á–µ–Ω–∏–µ cookies:**
   ```bash
   python tools/get_cookies.py
   # –°–æ–∑–¥–∞–µ—Ç—Å—è cookies/ozon_cookies.json
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ `.env`:**
   ```env
   OZON_MODE=full
   OZON_ACCOUNT_TYPE=foreign
   OZON_COOKIES_PATH=cookies/ozon_cookies.json
   ```

4. **–ó–∞–ø—É—Å–∫:**
   ```bash
   python parse_ozon_sellers.py
   ```

5. **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç cookies –∏–∑ —Ñ–∞–π–ª–∞
   - –î–µ–ª–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ curl_cffi
   - –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Playwright fallback
   - AdaptiveDelayer —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏
   - Seller API –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è (foreign –∞–∫–∫–∞—É–Ω—Ç)

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –•–æ—Å—Ç–∏–Ω–≥ (LIGHT —Ä–µ–∂–∏–º)

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –ü–ö:**
   ```bash
   python tools/get_cookies.py
   # –ü–æ–ª—É—á–∞–µ–º cookies/ozon_cookies.json
   ```

2. **–î–µ–ø–ª–æ–π –Ω–∞ Railway:**
   ```bash
   railway login
   railway init
   # –ó–∞–≥—Ä—É–∂–∞–µ–º cookies/ozon_cookies.json —á–µ—Ä–µ–∑ volumes
   # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   # OZON_MODE=light
   # OZON_ACCOUNT_TYPE=foreign
   # OZON_COOKIES_PATH=cookies/ozon_cookies.json
   railway up
   ```

3. **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
   - Railway —Å–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑ (~150 MB)
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ `requirements-core.txt` (–±–µ–∑ Playwright)
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç cookies –∏–∑ —Ñ–∞–π–ª–∞
   - –î–µ–ª–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ curl_cffi
   - –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ ‚Üí –æ—à–∏–±–∫–∞ (–Ω–æ —Å cookies –æ–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)
   - AdaptiveDelayer —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏
   - Seller API –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è (foreign –∞–∫–∫–∞—É–Ω—Ç)

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –î–æ –∏ –ü–æ—Å–ª–µ

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ | –ü–æ—Å–ª–µ |
|----------|-----|-------|
| **–†–∞–∑–º–µ—Ä Docker –æ–±—Ä–∞–∑–∞** | ~1.5 GB (—Å Playwright) | ~150 MB (–±–µ–∑ Playwright) |
| **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –Ω–æ–≤–æ–º –ü–ö** | –ú–Ω–æ–≥–æ —à–∞–≥–æ–≤ –≤—Ä—É—á–Ω—É—é | –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ (`install.sh`) |
| **–î–µ–ø–ª–æ–π –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥** | –°–ª–æ–∂–Ω–æ, –Ω—É–∂–µ–Ω Playwright | –ü—Ä–æ—Å—Ç–æ, –±–µ–∑ Playwright |
| **Cookies** | –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑ | –û–¥–∏–Ω —Ä–∞–∑ –ª–æ–∫–∞–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |
| **–ó–∞–¥–µ—Ä–∂–∫–∏** | –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ | –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ (—É–º–Ω—ã–µ) |
| **Seller API** | –í—Å–µ–≥–¥–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è | –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–ª—è foreign –∞–∫–∫–∞—É–Ω—Ç–∞ |
| **–†–µ–∂–∏–º—ã** | –û–¥–∏–Ω —Ä–µ–∂–∏–º | LIGHT (—Ö–æ—Å—Ç–∏–Ω–≥) / FULL (–ª–æ–∫–∞–ª—å–Ω–æ) |

---

## üéØ –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∑–∞–ø—É—Å–∫–∞:** –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏  
‚úÖ **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ö–æ—Å—Ç–∏–Ω–≥—É:** –õ–µ–≥–∫–∏–π Docker –æ–±—Ä–∞–∑, –±–µ–∑ Playwright  
‚úÖ **Cookies-as-a-Service:** –ü–æ–ª—É—á–∏–ª –ª–æ–∫–∞–ª—å–Ω–æ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –≤–µ–∑–¥–µ  
‚úÖ **–£–º–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞—Ö  
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å:** –†–µ–∂–∏–º—ã LIGHT/FULL –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤  

–ü–∞—Ä—Å–µ—Ä —Å—Ç–∞–ª **–ø—Ä–æ—â–µ, –±—ã—Å—Ç—Ä–µ–µ –∏ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É**! üöÄ
