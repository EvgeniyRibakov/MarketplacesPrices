Контекст проекта (для Cursor / ИИ-разработки)
Общая цель
Разработка MVP-версии высокоскоростного и устойчивого парсера цен и аналитики для e-commerce бьюти-компании, работающей на маркетплейсах Wildberries и Ozon.
Проект ориентирован не на идеальную чистоту архитектуры на старте, а на:
реальные финальные цены для покупателя,


максимальную скорость,


минимальный риск блокировок,


и создание фундамента для дальнейшего API-first решения.



Бизнес-контекст
Компания управляет несколькими брендами.


Используются 6 разных кабинетов продавца (6 юрлиц), полностью подконтрольных компании.


Цены используются:


для аналитики,


для ручного обновления цен менеджерами (data-driven подход).



Платформы и объём
Wildberries — ~900 SKU


Ozon — ~700 SKU


Всего ~1600 SKU


Обновление: каждые 1–2 часа


Целевое время выполнения: 5–10 минут на весь объём



Ключевые требования
Абсолютный приоритет — скорость


Минимальный риск блокировок аккаунтов и IP


Приоритет:


API (официальное и неофициальное)


XPath / HTML — только где другого выхода нет


Все методы считаются допустимыми и легальными в рамках задачи


Пока локальный скрипт, в перспективе — перенос на сервер



Термины
СПП (Скидка Постоянного Покупателя)
 Программа лояльности, автоматически применяемая маркетплейсом для активных покупателей.
 В карточке товара отображается как цена без карты, но уже со СПП (чёрная цена).

MVP: Wildberries
Источники
Используются 6 разных кабинетов продавца WB (6 юрлиц).

Что реализуется в MVP (WB)
1. Базовая цена / цена со скидкой
Источник: официальное API Wildberries
 Статус: реализуемо сразу
Используется:
для всех SKU,


из всех 6 кабинетов.


Плюсы:
высокая скорость,


стабильность,


минимальный риск блокировок.



2. Цена по WB-карте (цена с картой лояльности)
Источник: XPath-парсинг со страниц бренда / продавца
Пример страницы:
 https://www.wildberries.ru/brands/68941-likato-professional
Особенности:
парсинг выполняется от имени каждого из 6 продавцов,


уже существует рабочее решение,


обрабатывает все товары за ~1–2 минуты.


Это осознанный HTML-костыль, принятый для MVP.

3. Цена после СПП, но без карты (чёрная цена)
Назначение:
аналитика,


помощь менеджерам при ручном обновлении цен.


Текущий статус:
 ❗ Способ получения не зафиксирован.
Приоритетная стратегия поиска:
Поиск внутренних XHR / Fetch / GraphQL запросов WB:


seller-кабинет,


карточка товара,


price / promo / discount endpoints.


Анализ network-трафика через DevTools / mitmproxy.


Если API не найден — временный XPath fallback (нежелательно, но допустимо на MVP).


Важно:
 Цена должна соответствовать реальной цене покупателя без карты, но уже с учётом СПП.

MVP: Ozon
Общий контекст
Есть API-ключи и ID от кабинетов продавца Ozon.


Ozon имеет более жёсткую защиту, чем WB.



Что реализуется в MVP (Ozon)
1. Базовые цены
Источник: существующий агент
Агент скачивает отчёт цен из кабинета продавца Ozon.


Из отчёта парсятся базовые цены.


Решение считается временным, но стабильным.



2. Цена с картой лояльности Ozon (зелёная цена)
Критически важно:
 Цена должна соответствовать залогиненному пользователю
 с адресом ПВЗ:
г. Москва, ул. Никольская, д. 7–9, стр. 4
(в этой конфигурации отображаются минимально возможные цены).
Источник:
XPath / HTML-парсинг карточек товаров


либо любые другие инструменты (network, если удастся)


Статус:
экспериментальный,


потенциально нестабильный,


но принят для MVP.



Результаты research и принятые архитектурные решения
Что уже зафиксировано
Headless-браузеры — не основной путь


API и XHR — единственный масштабируемый вариант


XPath — допустим как временный костыль


MVP допускает гибридную архитектуру


Лучшие инструменты discovery (research-этап)
DevTools (Network)


Copy as fetch / Python requests


mitmproxy / Charles


Анализ seller-кабинетов, а не публичных страниц



Архитектурная установка MVP
Wildberries
Официальное API → базовая цена


XPath → цена WB-карты


Research → цена после СПП (чёрная)


Ozon
Агент → отчёт цен


XPath → зелёная цена (как у залогиненного клиента с ПВЗ в Москве)



Что должно быть на выходе MVP
Рабочий локальный скрипт


Быстрое обновление цен


Возможность:


сравнивать цены,


принимать решения менеджерами,


масштабировать решение позже


Понимание:


какие HTML-костыли можно заменить API,


какие API реально устойчивы.



Вектор развития после MVP
Уход от XPath → XHR / GraphQL


Минимизация HTML-парсинга


Перенос на сервер


Автоматизация и масштабирование



Сухое понятное саммари
Есть 6 кабинетов WB (6 юрлиц) и несколько брендов.
 MVP:
 WB — официальное API + XPath для цены с картой, цена после СПП в исследовании.
 Ozon — отчёт цен через агент + XPath зелёной цены как у залогиненного клиента с ПВЗ в Москве.
 Фокус — скорость, реальные финальные цены и практическая польза для аналитики и менеджеров.

